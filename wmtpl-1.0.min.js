/**
 * 万魔wm模板引擎v1.0
 * [盟东阳]
 * @param  {[type]} root    [description]
 * @param  {[type]} factory [description]
 * @return {[type]}         [description]
 */
(function(root,factory){if(typeof define==='function'&&define.amd){define(factory)}else if(typeof exports==='object'){var mo=factory();mo.__esModule=true;mo['default']=mo;module.exports=mo}else{root.wmtpl=factory()}}(this,function(){window.console=window.console||(function(){var c={};c.log=c.warn=c.debug=c.info=c.error=c.time=c.dir=c.profile=c.clear=c.exception=c.trace=c.assert=function(){};return c})();function render(content,data,config){if(config==undefined||config==''||arguments.length!=3){config={left_tpl_str:'{{',right_tpl_str:'}}',placeholder:'#',data_name:'data',tpl_debug:false,debug_error_message:"页面错误！"}}data=data||{};var list=['var newtpl = "";'];var codearray=getinitialdata(content,config);if(codearray==false){if(config.tpl_debug===true){return'预编译失败：左边或右边匹配符错误，未匹配到内容！'}else{return config.debug_error_message}}for(var i=0,len=codearray.length;i<len;i++){var things=codearray[i];if(things.type==1){list.push(things.txt)}else if(things.type==2){var txt='newtpl+='+things.txt+';';list.push(txt)}else{var txt='newtpl+="'+things.txt.replace(/"/g,'\\"')+'";';list.push(txt)}}list.push('return newtpl;');try{return new Function(config.data_name,list.join('\n'))(data)}catch(err){if(config.tpl_debug===true){return'预编译失败。'+err}else{return config.debug_error_message}}}function getinitialdata(content,config){var arr=[];var reg=new RegExp(config.left_tpl_str+"([\\s\\S]*?)"+config.right_tpl_str,"g");var match;var nowIndex=0;var placeholder=config.placeholder;while(match=reg.exec(content)){addtextarray(arr,content.substring(nowIndex,match.index));var things={type:1,txt:match[1]};if(match[1].substr(0,1)==placeholder){things.type=2;things.txt=things.txt.substr(1)}arr.push(things);nowIndex=match.index+match[0].length}if(arr==null||arr==''){return false}addtextarray(arr,content.substr(nowIndex));return arr}function addtextarray(list,content){content=content.replace(/\r?\n/g,"\\n");list.push({txt:content})}return render}));